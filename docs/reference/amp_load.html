<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Load data for ampvis functions — amp_load • ampvis2</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">ampvis2</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/ampvis2.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../articles/faq.html">FAQ</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/MadsAlbertsen/ampvis2">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Load data for ampvis functions</h1>
    </div>

    
    <p>This function reads an OTU-table and corresponding sample metadata, and returns a list for use in all ampvis functions. It is therefore required to load data with <code>amp_load</code> before any other ampvis functions can be used.</p>
    

    <pre class="usage"><span class='fu'>amp_load</span>(<span class='kw'>otutable</span> <span class='kw'>=</span> <span class='no'>dataframe</span>, <span class='kw'>metadata</span> <span class='kw'>=</span> <span class='no'>dataframe</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>otutable</th>
      <td><p>(<em>required</em>) OTU-table (data frame) with the read counts of all OTU's, where the last 7 columns is the taxonomy (Kingdom -&gt; Species).</p></td>
    </tr>
    <tr>
      <th>metadata</th>
      <td><p>(<em>required</em>) Sample metadata (dataframe) with information about the samples. If none provided, dummy metadata will be created.</p></td>
    </tr>
    <tr>
      <th>fasta</th>
      <td><p>(<em>optional</em>) Path to a FASTA file with reference sequences for all OTU's in the OTU-table. (<em>default:</em> <code>NULL</code>)</p></td>
    </tr>
    <tr>
      <th>tree</th>
      <td><p>(<em>optional</em>) Phylogenetic tree of class <code>"phylo"</code> as loaded with <code><a href='http://www.rdocumentation.org/packages/ape/topics/read.tree'>read.tree</a></code>. (<em>default:</em> <code>NULL</code>)</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of class <code>"ampvis2"</code> with 3 to 5 elements.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code>amp_load</code> function validates and corrects the provided data frames in different ways to make it suitable for the rest of the ampvis functions. It is important that the provided data frames match the requirements as described in the following sections to work properly.</p>
    
    <h2 class="hasAnchor" id="the-otu-table"><a class="anchor" href="#the-otu-table"></a>The OTU-table</h2>

    
    <p>The OTU-table contains information about the OTUs, their assigned taxonomy and their read counts in each sample. The provided OTU-table must be a data frame with the following requirements:</p><ul>
<li><p>The rows are OTU IDs and the columns are samples.</p></li>
<li><p>The last 7 columns are the corresponding taxonomy assigned to the OTUs, named <code>"Kingdom", "Phylum", "Class", "Order", "Family", "Genus", "Species"</code>.</p></li>
<li><p>The OTU ID's are expected to be in eiher the rownames of the data frame or in a column called "OTU". Otherwise the function will stop with a message.</p></li>
<li><p>The column names of the data frame are the sample IDs, exactly matching those in the metadata, (and the last 7 columns named <code>Kingdom</code> -&gt; <code>Species</code>, of course). Thus, the first row should contain the read counts of one of the OTUs in each sample, NOT the sample IDs and taxonomy.</p></li>
<li><p>Generally avoid special characters and spaces in row- and column names.</p></li>
</ul>
    <p>A minimal example is available with <code>data("example_otutable")</code>.</p>
    
    <h2 class="hasAnchor" id="the-metadata"><a class="anchor" href="#the-metadata"></a>The metadata</h2>

    
    <p>The metadata contains additional information about the samples, for example where each sample was taken, date, pH, treatment etc, which is used to compare and group the samples during analysis. The amount of information in the metadata is unlimited, it can contain any number of columns (variables), however there are a few requirements:</p><ul>
<li><p>The sample IDs must be in the first column. These sample IDs must match exactly to those in the OTU-table.</p></li>
<li><p>Column classes matter, categorical variables should be loaded either <code>as.character()</code> or <code>as.factor()</code>, and continuous variables <code>as.numeric()</code>. See below.</p></li>
<li><p>Generally avoid special characters and spaces in row- and column names.</p></li>
</ul>
    <p>If for example a column is named "Year" and the entries are simply entered as numbers (2011, 2012, 2013 etc), then R will automatically consider these as numerical values (<code>as.numeric()</code>) and therefore the column as a continuous variable, while it is a categorical variable and should be loaded <code>as.factor()</code> or <code>as.character()</code> instead. This has consequences for the analysis as R treats them differently. Therefore either use the <code>colClasses = </code> argument when loading a csv file or <code>col_types = </code> when loading an excel file, or manually adjust the column classes afterwards with fx <code>metadata$Year &lt;- as.character(metadata$Year)</code>.</p>
<p>The <code>amp_load</code> function will automatically use the sample IDs in the first column as rownames, but it is important to also have an actual column with sample IDs, so it is possible to fx group by that column during analysis. Any unmatched samples between the otutable and metadata will be removed.</p>
<p>A minimal example is available with <code>data("example_metadata")</code>.</p>
    
    <h2 class="hasAnchor" id="reference-sequences"><a class="anchor" href="#reference-sequences"></a>Reference sequences</h2>

    
    <p>A fasta file with the raw sequences can be loaded as well, which will then be available in the refseq element of the ampvis2 object. These sequences will not be used in any ampvis2 function other than the two subset functions <code><a href='amp_subset_samples.html'>amp_subset_samples</a></code> and <code><a href='amp_subset_taxa.html'>amp_subset_taxa</a></code>, so that they can be exported with <code><a href='amp_export_fasta.html'>amp_export_fasta</a></code>. The fasta file is loaded with the <code><a href='http://www.rdocumentation.org/packages/ape/topics/read.dna'>read.FASTA</a></code> function from the <code>ape</code> package.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>#Be sure to use the correct function to load your .csv files, see ?read.table()

</div><span class='co'># NOT RUN {</span>
<span class='co'>#Read the OTU-table as a data frame. It is important to set check.names = FALSE.</span>
<span class='no'>myotutable</span> <span class='kw'>&lt;-</span> <span class='fu'>read.delim</span>(<span class='st'>"data/otutable.txt"</span>, <span class='kw'>check.names</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='co'>#Read the metadata, often an excel sheet. If .csv make sure the first column will be kept and NOT </span>
<span class='co'>#loaded as rownames! The top row should be loaded column names</span>
<span class='no'>mymetadata</span> <span class='kw'>&lt;-</span> <span class='fu'>read_excel</span>(<span class='st'>"data/metadata.xlsx"</span>, <span class='kw'>col_names</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='co'>#Combine the data with amp_load() to make it compatible with ampvis2 functions.</span>
<span class='co'>#Uncomment the fasta line to load reference sequences (not required).</span>
<span class='no'>d</span> <span class='kw'>&lt;-</span> <span class='fu'>amp_load</span>(<span class='kw'>otutable</span> <span class='kw'>=</span> <span class='no'>myotutable</span>,
              <span class='kw'>metadata</span> <span class='kw'>=</span> <span class='no'>mymetadata</span>,
              <span class='kw'>fasta</span> <span class='kw'>=</span> <span class='st'>"path/to/fastafile.fa"</span> <span class='co'>#optional</span>
              )

<span class='co'>#Show a short summary about the data by simply typing the name of the object in the console</span>
<span class='no'>d</span>
<span class='co'># }</span><div class='input'>
<span class='co'>#Minimal example metadata:</span>
<span class='fu'>data</span>(<span class='st'>"example_metadata"</span>)
<span class='no'>example_metadata</span></div><div class='output co'>#&gt; # A tibble: 8 x 4
#&gt;      SampleID     Plant       Date  Year
#&gt;         &lt;chr&gt;     &lt;chr&gt;     &lt;dttm&gt; &lt;dbl&gt;
#&gt; 1 16SAMP_3893 Aalborg E 2014-02-06  2014
#&gt; 2 16SAMP_3913 Aalborg E 2014-07-03  2014
#&gt; 3 16SAMP_3941 Aalborg E 2014-08-19  2014
#&gt; 4 16SAMP_3946 Aalborg E 2014-11-13  2014
#&gt; 5 16SAMP_3953 Aalborg W 2014-02-04  2014
#&gt; 6 16SAMP_4591 Aalborg W 2014-05-05  2014
#&gt; 7 16SAMP_4597 Aalborg W 2014-08-18  2014
#&gt; 8 16SAMP_4603 Aalborg W 2014-11-12  2014</div><div class='input'>
<span class='co'>#Minimal example otutable:</span>
<span class='fu'>data</span>(<span class='st'>"example_otutable"</span>)
<span class='no'>example_otutable</span></div><div class='output co'>#&gt;        16SAMP_3893 16SAMP_3913 16SAMP_3941 16SAMP_3946 16SAMP_3953 16SAMP_4591
#&gt; OTU_1           23          15         273          51         127         190
#&gt; OTU_2          675         565         331         411         430         780
#&gt; OTU_3          780         733         405         199        1346        1114
#&gt; OTU_4          272         233        1434         256         736        1338
#&gt; OTU_5          560         339         509         598         223         145
#&gt; OTU_6          906         766         133         390         232        1458
#&gt; OTU_7          297         218         418         130        1354         198
#&gt; OTU_8           28           8         155          72         156         101
#&gt; OTU_9            0           0           9           0          19          25
#&gt; OTU_10         373         256          19         415          43         102
#&gt;        16SAMP_4597 16SAMP_4603     Kingdom            Phylum
#&gt; OTU_1          220          83 k__Bacteria    p__Chloroflexi
#&gt; OTU_2          699         820 k__Bacteria p__Actinobacteria
#&gt; OTU_3         1630         112 k__Bacteria p__Actinobacteria
#&gt; OTU_4         1224         564 k__Bacteria p__Proteobacteria
#&gt; OTU_5          212        1619 k__Bacteria    p__Chloroflexi
#&gt; OTU_6          560         287 k__Bacteria     p__Firmicutes
#&gt; OTU_7          283         116 k__Bacteria p__Actinobacteria
#&gt; OTU_8          151          25 k__Bacteria    p__Nitrospirae
#&gt; OTU_9           58           0 k__Bacteria  p__Bacteroidetes
#&gt; OTU_10          73         138 k__Bacteria  p__Bacteroidetes
#&gt;                        Class                 Order                Family
#&gt; OTU_1              c__SJA-15           o__C10_SB1A           f__C10_SB1A
#&gt; OTU_2      c__Actinobacteria      o__Micrococcales f__Intrasporangiaceae
#&gt; OTU_3      c__Acidimicrobiia   o__Acidimicrobiales    f__Microthricaceae
#&gt; OTU_4  c__Betaproteobacteria      o__Rhodocyclales     f__Rhodocyclaceae
#&gt; OTU_5        c__Anaerolineae     o__Anaerolineales    f__Anaerolineaceae
#&gt; OTU_6             c__Bacilli    o__Lactobacillales  f__Carnobacteriaceae
#&gt; OTU_7      c__Acidimicrobiia   o__Acidimicrobiales    f__Microthricaceae
#&gt; OTU_8          c__Nitrospira      o__Nitrospirales     f__Nitrospiraceae
#&gt; OTU_9    c__Sphingobacteriia o__Sphingobacteriales     f__Saprospiraceae
#&gt; OTU_10   c__Sphingobacteriia o__Sphingobacteriales     f__Saprospiraceae
#&gt;                              Genus         Species
#&gt; OTU_1     g__Candidatus Amarilinum             s__
#&gt; OTU_2              g__Tetrasphaera             s__
#&gt; OTU_3     g__Candidatus Microthrix             s__
#&gt; OTU_4             g__Dechloromonas             s__
#&gt; OTU_5  g__Candidatus Villogracilis             s__
#&gt; OTU_6              g__Trichococcus             s__
#&gt; OTU_7     g__Candidatus Microthrix             s__
#&gt; OTU_8                g__Nitrospira s__sublineage I
#&gt; OTU_9                 g__QEDR3BF09             s__
#&gt; OTU_10                     g__MK04             s__</div><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#the-otu-table">The OTU-table</a></li>

      <li><a href="#the-metadata">The metadata</a></li>

      <li><a href="#reference-sequences">Reference sequences</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Kasper Skytte Andersen <a href='mailto:kasperskytteandersen@gmail.com'>kasperskytteandersen@gmail.com</a>

Mads Albertsen <a href='mailto:MadsAlbertsen85@gmail.com'>MadsAlbertsen85@gmail.com</a>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Mads Albertsen, Kasper Skytte Andersen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
